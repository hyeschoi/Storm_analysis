{
    "contents" : "##----------------------------------------------------------------------------------------------\n#   Header\n##----------------------------------------------------------------------------------------------\n# Author : Hye Soo Choi\n# Date: August 13, 2015\n# Description: This part consists on analyzing data of the North Atlantic Basin \n#   for the period between 1980 - 2010. will navigate storms' behavior by observing\n#   frequency table and plot of number of storms per year and per month, \n#   applying linear regression to see a pattern between pressure and wind speed.\n#   \n#\n##----------------------------------------------------------------------------------------------\n#   Packages\n##----------------------------------------------------------------------------------------------\n\nlibrary(readr)\nlibrary(ggplot2)\nlibrary(dplyr)\n\n##----------------------------------------------------------------------------------------------\n#   Data import\n##----------------------------------------------------------------------------------------------\n\nstorms <- read_csv('./data/storms.csv')\ntracks <- read_csv('./data/tracks.csv')\n\n# Coerce date into Date class for future use\nstorms$date <- as.Date(storms$date, format = '%m/%d/%Y')\ntracks$date <- as.Date(tracks$date, format = '%m/%d/%Y')\n\n\n# Filter two data frames with year in between 1980 and 2010\nstorms <- storms %>% filter (format(date, format = '%Y') >= 1980 & \n                               format(date, format = '%Y') <= 2010)\ntracks <- tracks %>% filter (format(date, format = '%Y') >= 1980 & \n                               format(date, format = '%Y') <= 2010)\n\n##----------------------------------------------------------------------------------------------\n#   Frequency table and Barplot\n##----------------------------------------------------------------------------------------------\n\n# Obtain frequencies and barplot for number of storms per YEAR\nfreq.year <- storms %>%  group_by(format( date, format = '%Y')) %>% summarise( count = n()) \nnames(freq.year) <- c('year', 'count')\nfreq.year\n\n# Save plot in PDF and PNG\npdf('./images/storm_year.pdf')\nggplot(freq.year, aes (x = year, y = count)) + geom_bar(stat = 'identity') +\n  theme(text = element_text(size = 11),\n        axis.text.x = element_text(angle = 90),\n        plot.title=element_text(size = 15)) +\n  ggtitle('Number of Storms per Year') + xlab('Year')\ndev.off()\n\npng('./images/storm_year.png', width = 480, height = 480)\nggplot(freq.year, aes (x = year, y = count)) + geom_bar(stat = 'identity') +\n  theme(text = element_text(size = 11),\n        axis.text.x = element_text(angle = 90),\n        plot.title=element_text(size = 15)) +\n  ggtitle('Number of Storms per Year') + xlab('Year')\ndev.off()\n\n\n# maximum of wind speed for each storm\nmax.wind <- tracks %>% group_by( id ) %>% summarise( max.wind = max(wind))\n\n\n# id of the storms with max wind speed >= 35 knots\nid35 <- max.wind$id[ max.wind$max.wind >= 35]\n\n# Obtain frequency table and barplot for \n# number of storms per year with max wind speed >= 35 knots\nfreq.year.35 <- storms %>% filter(id %in% id35) %>% group_by(format(date, format = '%Y')) %>% tally()\nnames(freq.year.35) <- c('year', 'count')\nfreq.year.35\n\n# Save plot in PDF and in PNG\npdf('./images/wind35_year.pdf')\nggplot(freq.year.35 , aes (x = year, y = count)) + geom_bar( stat = 'identity') +\n  theme(text = element_text(size = 11),\n        axis.text.x = element_text(angle = 90),\n        plot.title=element_text(size = 15)) +\n  ggtitle('Number of Storms with winds >= 35 knots per Year') + xlab('Year')\ndev.off()\n\npng('./images/wind35_year.png', width = 480, height = 480)\nggplot(freq.year.35 , aes (x = year, y = count)) + geom_bar( stat = 'identity') +\n  theme(text = element_text(size = 11),\n        axis.text.x = element_text(angle = 90),\n        plot.title=element_text(size = 15)) +\n  ggtitle('Number of Storms with winds >= 35 knots per Year') + xlab('Year')\ndev.off()\n\n# id of the storms with max wind speed >= 64 knots\nid64 <- max.wind$id[max.wind$max.wind >= 64]\n\n# Obtain frequency table and barplot for\n# Number of storms per year with max wind speed >= 64 knots\nfreq.year.64 <- storms %>%filter(id %in% id64) %>% group_by(format(date, format = '%Y')) %>% tally()\nnames(freq.year.64) <- c('year', 'count')\nfreq.year.64\n\n# Save plot in PDF and in PNG\npdf('./images/wind64_year.pdf')\nggplot(freq.year.64 , aes (x = year, y = count)) + geom_bar( stat = 'identity') +\n  theme(text = element_text(size = 11),\n        axis.text.x = element_text(angle = 90),\n        plot.title=element_text(size = 15)) +\n  ggtitle('Number of Storms with winds >= 64 knots per Year') + xlab('Year')\ndev.off()\n\npng('./images/wind64_year.png', width = 480, height = 480)\nggplot(freq.year.64 , aes (x = year, y = count)) + geom_bar( stat = 'identity') +\n  theme(text = element_text(size = 11),\n        axis.text.x = element_text(angle = 90),\n        plot.title=element_text(size = 15)) +\n  ggtitle('Number of Storms with winds >= 64 knots per Year') + xlab('Year')\ndev.off()\n\n\n# id of the storms with max wind speed >= 96 knots\nid96 <- max.wind$id[max.wind$max.wind >= 96]\n\n# Obtain frequency table and barplot for\n# number of storms per year with max wind speed >= 96 knots\nfreq.year.96 <- storms %>% filter(id %in% id96) %>% group_by(format(date, format = '%Y')) %>% tally()\nnames(freq.year.96) <- c('year', 'count')\nfreq.year.96\n\n# Save plot in PDF and in PNG\npdf('./images/wind96_year.pdf')\nggplot(freq.year.96 , aes (x = year, y = count)) + geom_bar( stat = 'identity') +\n  theme(text = element_text(size = 11),\n        axis.text.x = element_text(angle = 90),\n        plot.title = element_text(size = 15)) +\n  ggtitle('Number of Storms with winds >= 96 knots per Year') + xlab('Year')\ndev.off()\n\npng('./images/wind96_year.png', width = 480, height = 480)\nggplot(freq.year.96 , aes (x = year, y = count)) + geom_bar( stat = 'identity') +\n  theme(text = element_text(size = 11),\n        axis.text.x = element_text(angle = 90),\n        plot.title = element_text(size = 15)) +\n  ggtitle('Number of Storms with winds >= 96 knots per Year') + xlab('Year')\ndev.off()\n\n\n# Obtain frequency table and barplot for\n# number of storms per MONTH\nfreq.month <- storms %>% group_by(format(date, format = '%m')) %>% tally()\nnames(freq.month) <- c('month', 'count')\nfreq.month\n\n# Save plot in PDF and in PNG \npdf('./images/storm_month.pdf')\nggplot(freq.month , aes (x = month, y = count)) + geom_bar( stat = 'identity') +\n  ggtitle('Number of Storms per Month') + xlab('Month')\ndev.off()\n\npng('./images/storm_month.png')\nggplot(freq.month , aes (x = month, y = count)) + geom_bar( stat = 'identity') +\n  ggtitle('Number of Storms per Month') + xlab('Month')\ndev.off()\n\n\n\n# Obtain frequencies and barplot for\n# number of storms per month with max wind speed >= 35 knots\nfreq.month.35 <- storms %>% filter(id %in% id35) %>% group_by(format(date, format = '%m')) %>% tally()\nnames(freq.month.35) <- c('month', 'count')\nfreq.month.35\n\n\n# Save plot in PDF and in PNG\npdf('./images/wind35_month.pdf')\nggplot(freq.month.35 , aes (x = month, y = count)) + geom_bar( stat = 'identity') +\n  ggtitle('Number of Storms with Wind Speed >= 35 per Month') + xlab('Month')\ndev.off()\n\npng('./images/wind35_month.png')\nggplot(freq.month.35 , aes (x = month, y = count)) + geom_bar( stat = 'identity') +\n  ggtitle('Number of Storms with Wind Speed >= 35 per Month') + xlab('Month')\ndev.off()\n\n\n\n# Obtain frequency table and barplot for\n# number of storms per month with max wind speed >= 64 knots\nfreq.month.64 <- storms %>% filter(id %in% id64) %>% group_by(format(date, format = '%m')) %>% tally()\nnames(freq.month.64) <- c('month', 'count')\nfreq.month.64\n\n# Save plot in PDF and in PNG\npdf('./images/wind64_month.pdf')\nggplot(freq.month.64 , aes (x = month, y = count)) + geom_bar( stat = 'identity') +\n  ggtitle('Number of Storms with Wind Speed >= 64 per Month') + xlab('Month')\ndev.off()\n\npng('./images/wind64_month.png')\nggplot(freq.month.64 , aes (x = month, y = count)) + geom_bar( stat = 'identity') +\n  ggtitle('Number of Storms with Wind Speed >= 64 per Month') + xlab('Month')\ndev.off()\n\n\n# Obtain frequency table and barplot for\n# number of storms per year with max wind speed >= 96 knots\nfreq.month.96 <- storms %>% filter(id %in% id96) %>% group_by(format(date, format = '%m')) %>% tally()\nnames(freq.month.96) <- c('month', 'count')\nfreq.month.96\n\n# Save plot in PDF and PNG\npdf('./images/wind96_month.pdf')\nggplot(freq.month.96 , aes (x = month, y = count)) + geom_bar( stat = 'identity') +\n  ggtitle('Number of Storms with Wind Speed >= 96 per Month') + xlab('Month')\ndev.off()\n\npng('./images/wind96_month.png')\nggplot(freq.month.96 , aes (x = month, y = count)) + geom_bar( stat = 'identity') +\n  ggtitle('Number of Storms with Wind Speed >= 96 per Month') + xlab('Month')\ndev.off()\n\n##----------------------------------------------------------------------------------------------\n#   Summary statistics\n##----------------------------------------------------------------------------------------------\n\n# Observe summary statistics of annual average mean number of storms \n# with maximum wind speed at least 35 knots\n\n# average \nfreq.year.35 %>% summarise(mean(count))\n\n# standard deviation\nfreq.year.35 %>% summarise(sd(count))\n\n# 25th percentile\nquantile(freq.year.35$count, probs = 0.25)\n\n\n# 50th percentile\nquantile(freq.year.35$count, probs = 0.5)\n\n\n# 75th percentile\nquantile(freq.year.35$count, probs = 0.75)\n\n\n# Obeserve summary statistics of Annual average mean number of storms \n# with maximum winds at least 64 knots\n\n# average \nmean(freq.year.64$count)\n\n\n# standard deviation\nsd(freq.year.64$count)\n\n\n# 25th percentile\nquantile(freq.year.64$count, probs = 0.25)\n\n\n# 50th percentile\nquantile(freq.year.64$count, probs = 0.5)\n\n\n# 75th percentile\nquantile(freq.year.64$count, probs = 0.75)\n\n\n# Observe summary statistics of annual average mean number of storms \n# with maximum winds of at least 96 knots\n\n# average \nmean(freq.year.96$count)\n\n# standard deviation\nsd(freq.year.96$count)\n\n# 25th percentile\nquantile(freq.year.96$count, probs = 0.25)\n\n# 50th percentile\nquantile(freq.year.96$count, probs = 0.5)\n\n# 75th percentile\nquantile(freq.year.96$count, probs = 0.75)\n\n##----------------------------------------------------------------------------------------------\n#   Regression\n##----------------------------------------------------------------------------------------------\n# Regression analysis 1: mean pressure and mean wind speed for each storm \n# (without observations with mean pressure = 0)\n\n# mean pressure for each storm\nmean.press <- tracks %>% group_by(id) %>% summarise( mean(press) )\nnames(mean.press) <- c('id','mean.press')\n\n# mean wind speed for each storm\nmean.wind <- tracks %>% group_by(id) %>% summarise(mean(wind))\nnames(mean.wind) <- c('id','mean.wind')\n\n# merge two mean vectors into a data frame\nmean.pw <- inner_join(mean.press, mean.wind)\n\n# get rid of storms whose mean pressure = 0\nmean.pw <- mean.pw %>% filter(mean.press > 0)\n\n\n# Regression analysis 2: median pressure and median wind speed for each storm \n# (without observations with median pressure = 0)\n\n# median pressure for each storm\nmedian.press <- tapply(tracks$press, tracks$id, median)\n\n# median wind speed for each storm\nmedian.wind <- tapply(tracks$wind, tracks$id, median)\n\n# merge two median vectors into a data frame\nmedian.pw <- as.data.frame(cbind(unique(tracks$id), median.press, median.wind))\n\n# remove storms whose median pressure = 0\nmedian.pw <- subset(median.pw, median.press > 0)\n\n\n# Draw a plot for each regression line \n\n\n# Save regression graph on median in PDF and in PNG\npdf(\"./images/regression_median_pw.pdf\")\nggplot(median.pw, aes(x = median.press, y = median.wind)) + \n  geom_point() + \n  geom_smooth(method = lm, se = FALSE) + \n  ggtitle ('Median of Wind speed and Pressure for each Storm') +\n  ylab('Pressure (mb)') + \n  xlab('Wind speed (knots)')\ndev.off()\n\npng(\"./images/regression_median_pw.png\")\nggplot(median.pw, aes(x = median.wind, y = median.press)) + \n  geom_point() + \n  geom_smooth(method = lm, se = FALSE) + \n  ggtitle ('Median of Wind speed and Pressure for each Storm') +\n  ylab('Pressure (mb)') + \n  xlab('Wind speed (knots)')\ndev.off()\n\n\n# Save regression graph on mean in PDF and in PNG\npdf('./images/regression_mean_pw.pdf')\nggplot(mean.pw, aes(x = mean.wind, y = mean.press)) + \n  geom_point() + \n  geom_smooth(method = lm, se = FALSE) + \n  ggtitle ('Mean of Wind speed and Pressure for each Storm') +\n  ylab('Pressure (mb)') + \n  xlab('Wind speed (knots)')\ndev.off()\n\npng('./images/regression_mean_pw.png')\nggplot(mean.pw, aes(x = mean.wind, y = mean.press)) + \n  geom_point() + \n  geom_smooth(method = lm, se = FALSE) + \n  ggtitle ('Mean of Wind speed and Pressure for each Storm') +\n  ylab('Pressure (mb)') + \n  xlab('Wind speed (knots)')\ndev.off()\n\n##----------------------------------------------------------------------------------------------\n#   Save\n##----------------------------------------------------------------------------------------------\n\n# Merge all freq.month table\ntemp <- merge(freq.month, freq.month.35, by = 'month', all = TRUE)\ntemp <- merge(temp, freq.month.64, by = 'month', all = TRUE)\nfreq.month.df <- merge(temp, freq.month.96, by = 'month', all = TRUE)\ncolnames(freq.month.df) <- c('month','count', 'count.35', 'count.64', 'count.96')\n\n# Merge all freq.year table\ntemp <- merge(freq.year, freq.year.35, by = 'year', all = TRUE)\ntemp <- merge(temp, freq.year.64, by = 'year', all = TRUE)\nfreq.year.df <- merge(temp, freq.year.96, by = 'year', all = TRUE)\ncolnames(freq.year.df) <- c('month','count', 'count.35', 'count.64', 'count.96')\n\n# Save tables as csv files\nwrite_csv(freq.month.df, './data/freq_month.csv')\nwrite_csv(freq.year.df, './data/freq_year.csv')\n",
    "created" : 1439316659057.000,
    "dirty" : true,
    "encoding" : "UTF-8",
    "folds" : "",
    "hash" : "498452909",
    "id" : "55D13B7",
    "lastKnownWriteTime" : 1439614176,
    "path" : "~/Downloads/Final_project 2/code/Data_analysis.R",
    "project_path" : "code/Data_analysis.R",
    "properties" : {
    },
    "relative_order" : 3,
    "source_on_save" : false,
    "type" : "r_source"
}