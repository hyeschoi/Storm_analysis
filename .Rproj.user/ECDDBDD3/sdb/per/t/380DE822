{
    "contents" : "##----------------------------------------------------------------------------------------------\n#   Header\n##----------------------------------------------------------------------------------------------\n# Author : Hye Soo Choi\n# Date: August 13, 2015\n# Description: The third part of the project consists of visualizing the trajectory of the storms \n# in both the East Pacific (EP) and the North Atlantic (NA) basins, for the period 1980-2010.\n#\n# For these visualizations, following data were used:\n#  ftp://eclipse.ncdc.noaa.gov/pub/ibtracs/v03r06/wmo/csv/basin/Basin.EP.ibtracs_wmo.v03r06.csv\n#  ftp://eclipse.ncdc.noaa.gov/pub/ibtracs/v03r06/wmo/csv/basin/Basin.NA.ibtracs_wmo.v03r06.csv\n# \n#\n##----------------------------------------------------------------------------------------------\n#   Packages\n##----------------------------------------------------------------------------------------------\nlibrary(readr)\nlibrary(ggplot2)\nlibrary(dplyr)\nlibrary(maps)\n\n##----------------------------------------------------------------------------------------------\n#   Data import\n##----------------------------------------------------------------------------------------------\n\n# storm data in the East Pacific (EP) basin\nep <- read_csv('./rawdata/Basin.EP.ibtracs_wmo.v03r06.csv', skip = 1)\n# remove unnecessary first line\nep <- ep[-1, ] \n\n\n# storm data in the North Atlantic (NA) basin\nna <- read_csv('./rawdata/Basin.NA.ibtracs_wmo.v03r06.csv', skip = 1)\n# remove unnecessary first line\nna <- na[-1, ] \n\n##----------------------------------------------------------------------------------------------\n#   Data process\n##----------------------------------------------------------------------------------------------\n\n# merge two data ep and na into single data frame naemd 'epna'\nepna <- rbind(ep, na)\n\n# Extract month and add it as new column named 'month'\nepna$month <- format(strptime(epna$ISO_time, '%Y-%m-%d %H:%M:%S'), '%m')\n\n# For future use, rename column names: year, serial.num, wind, press\nepna <- epna %>% rename(year = Season)\nepna <- epna %>% rename (serial.num = Serial_Num)\ncolnames(epna)[c(11,12)] <- c('wind','press')\n\n# Select only variables that we are intersted in :\n#     year, Basin, month, Latitude, Longitude, wind, press, serial.num\nepna <- epna %>% select(year, Basin, month, Latitude, Longitude, wind, press, serial.num)\ncolnames(epna) <- tolower(colnames(epna))\n\n# coerce to numeric, if necessary\nepna$latitude <- as.numeric(epna$latitude)\nepna$longitude <- as.numeric(epna$longitude)\nepna$wind <- as.numeric(epna$wind)\nepna$press <- as.numeric(epna$press)\n\n# Filter data by 60 >= latitude >= 0 and longitude >= 0 \nepna <- epna %>% filter(longitude <= 0, latitude >= 0, latitude <=  60) \n\n# Filter data by year between 1980-2010\nepna <- epna %>% filter(year <= 2010 & year >= 1980)\n\n\n##----------------------------------------------------------------------------------------------\n#   Visualization\n##----------------------------------------------------------------------------------------------\n\n\n# retrieve map that spans over North Atlantic and East Pacific from world map\nworld <- map_data('world')\nworld.epna <- world %>% filter(long <= 0, lat >=  0, lat <= 60)\n\n\n# Draw all storm tracks between 1980-2010 on the map of NA and EP\ngg.map <- ggplot() + geom_polygon (data = world.epna, \n             aes(x = long, y = lat, group = group), colour=\"#dd855c40\", fill=\"#dfc68a\")\n\nepna.map <- gg.map + geom_path(data = epna, aes(x = longitude, y = latitude, \n               col = cut(wind, c(0,50,100,150,200), include.lowest = TRUE), \n               group = serial.num), size = 0.3) +\n               xlab('Longitude') + \n               ylab('Latitude') + \n               theme(panel.background = element_rect(fill = \"#d7e5e5\"),\n                     panel.grid.major = element_blank(),\n                     panel.grid.minor = element_blank()) +\n               scale_x_continuous(expand=c(0,0)) + scale_y_continuous(expand=c(0,0)) +\n               scale_color_manual(values=c('#5ab7fd', '#2ea5ff', '#0091ff','#4494d1'),\n                                  'Wind (knots)')\n\n# Save the plot in PDF and in PNG\npdf('./images/EPNAmap.pdf', width = 12, height = 4)\nepna.map + ggtitle('Storm trajectories between 1980 and 2010')\ndev.off()\n\npng('./images/EPNAmap.png', width = 720, height = 240)\nepna.map  + ggtitle('Storm trajectories between 1980 and 2010')\ndev.off()\n\n# ======================= Storm tracks per month =================================================\n# Draw storm tracks per month between 1980 - 2010. \n# and save it in PDF and in PNG\npdf('./images/EPNAmap_month.pdf', width = 18, height = 9)\nepna.map + facet_wrap( ~ month) + ggtitle('Storm trajectories by month between 1980 and 2010')\ndev.off()\n\npng('./images/EPNAmap_month.png', width = 720, height = 360)\nepna.map + facet_wrap( ~ month) + ggtitle('Storm trajectories by month between 1980 and 2010')\ndev.off()\n\n# ===================== Strom tracks per year =================================================\n\n# storm tracks in 1980s\nepna.1980s <- epna %>% filter (year %in% 1980:1989) \n\n# map that shows storm tracks in 1980s\nmap.1980s <- gg.map + geom_path(data = epna.1980s, aes(x = longitude, y = latitude, \n             col = cut(wind, breaks = c(0, 50, 100, 150, 200), include.lowest = TRUE),\n             group = serial.num), size = 0.3) +\n             xlab('Longitude') + \n             ylab('Latitude') +\n             theme( panel.background = element_rect(fill = \"#d7e5e5\"),\n                    panel.grid.major = element_blank(),\n                    panel.grid.minor = element_blank()) +\n             scale_x_continuous(expand = c(0,0)) + \n             scale_y_continuous(expand = c(0,0)) +\n             scale_color_manual(values = c('#5ab7fd', '#2ea5ff', '#0091ff','#4494d1'),\n                                'Wind (knots)') \n\n# Save the map of storm tracks per year in 1980s\npdf('./images/EPNAmap_1980s.pdf', width = 18, height = 9)\nmap.1980s + facet_wrap( ~ year) + ggtitle(\"Storm trajectories by year in 1980s\")\ndev.off()\n\npng('./images/EPNAmap_1980s.png', width = 720, height = 360)\nmap.1980s + facet_wrap( ~ year) + ggtitle(\"Storm trajectories by year in 1980s\")\ndev.off()\n\n# storm tracks in 1990s\nepna.1990s <- epna %>% filter (year %in% 1990:1999) \n\n# map that shows storm tracks in 1990s\nmap.1990s <- gg.map + geom_path(data = epna.1990s, aes(x = longitude, y = latitude, \n             col = cut(wind, breaks = c(0, 50, 100, 150, 200), include.lowest = TRUE), group = serial.num), \n             size = 0.3) + \n             xlab('Longitude') + \n             ylab('Latitude') +\n             theme( panel.background = element_rect(fill = \"#d7e5e5\"),\n                     panel.grid.major = element_blank(),\n                     panel.grid.minor = element_blank()) +\n             scale_x_continuous(expand = c(0,0)) + scale_y_continuous(expand = c(0,0)) +\n             scale_color_manual(values = c('#5ab7fd', '#2ea5ff', '#0091ff','#4494d1'), \n                                'Wind (knots)') \n\n# Save the map of storm trajectories by year in 1990s\npdf('./images/EPNAmap_1990s.pdf', width = 18, height = 9)\nmap.1990s + facet_wrap( ~ year) + ggtitle(\"Storm trajectories by year 1990s\")\ndev.off()\n\npng('./images/EPNAmap_1990s.png', width = 720, height = 360)\nmap.1990s + facet_wrap( ~ year) + ggtitle(\"Storm trajectories by year 1990s\")\ndev.off()\n\n# storm tracks in 2000s\nepna.2000s <- epna %>% filter (year %in% 2000:2010) \n\n# map that shows storm trajectories in 2000s\nmap.2000s <- gg.map + geom_path(data = epna.2000s, aes(x = longitude, y = latitude, \n        col = cut(wind, breaks = c(0, 50, 100, 150, 200), include.lowest = TRUE), \n        group = serial.num), size = 0.3) + \n        xlab('Longitude') + \n        ylab('Latitude') +\n        theme( panel.background = element_rect(fill = \"#d7e5e5\"),\n               panel.grid.major = element_blank(),\n               panel.grid.minor = element_blank()) +\n        scale_x_continuous(expand = c(0,0)) + scale_y_continuous(expand = c(0,0)) +\n        scale_color_manual(values = c('#5ab7fd', '#2ea5ff', '#0091ff','#4494d1'), \n                           'Wind (knots)') \n\n# Save the map of storm trajectories by year in 2000s\npdf('./images/EPNAmap_2000s.pdf', width = 18, height = 9)\nmap.2000s + facet_wrap( ~ year) + ggtitle(\"Storm trajectories by year in 2000s\")\ndev.off()\n\npng('./images/EPNAmap_2000s.png', width = 720, height = 360)\nmap.2000s + facet_wrap( ~ year) + ggtitle(\"Storm trajectories by year in 2000s\")\ndev.off()\n\n\n##----------------------------------------------------------------------------------------------\n#   Save\n##----------------------------------------------------------------------------------------------\n\n# Save cleaned data frame as csv file for possible future use\nwrite_csv(epna, './data/EPNA1980_2010.csv')\n\n",
    "created" : 1439316686025.000,
    "dirty" : false,
    "encoding" : "UTF-8",
    "folds" : "",
    "hash" : "3739666507",
    "id" : "380DE822",
    "lastKnownWriteTime" : 1439585042,
    "path" : "~/Downloads/Final_project 2/code/Visualization.R",
    "project_path" : "code/Visualization.R",
    "properties" : {
    },
    "relative_order" : 4,
    "source_on_save" : false,
    "type" : "r_source"
}